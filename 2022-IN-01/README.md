Вашите колеги от съседната лаборатория работят със специализирана система Hoge, която
съхранява данните си в binary файлове. За съжаление обаче им се налага да работят с две различни
версии на системата (стара и нова) и разбира се, те ползват различни файлови формати.
Вашата задача е да напишете програма на C (. / m a i n l i s t . b i n d a t a . b i n o u t . b i n ), която конвертира
файлове с данни от стария (l i s t . b i n + d a t a . b i n ) в новия (o u t . b i n ) формат.
Всички файлове се състоят от две секции – 8 байтов хедър и данни. Структурата на хедъра е:
• u i n t 1 6 _ t , m a g i c – магическа стойност 0 x 5 A 4 D , която дефинира, че файлът е от системата Hoge
и следва тази спецификация;
• u i n t 1 6 _ t , f i l e t y p e – дефинира какъв тип файл е това, с допустими стойности 1 за l i s t . b i n , 2
за d a t a . b i n и 3 за o u t . b i n ;
• u i n t 3 2 _ t , c o u n t – дефинира броя на елементите в секцията с данни на файла.
Секцията за данни на всички файлове съдържа елементи – цели числа без знак, от съответните типо-
ве:
• l i s t . b i n – u i n t 1 6 _ t ;
• d a t a . b i n – u i n t 3 2 _ t ;
• o u t . b i n – u i n t 6 4 _ t .
Във файлове d a t a . b i n и o u t . b i n елементи, чиято стойност е 0, са валидни елементи, но се игнорират
от системата Hoge (тяхното наличие във файла не пречи на работата на системата).
Всеки елемент в секцията за данни на l i s t . b i n има две характеристики – позиция и стойност, като
позиция е отместването на съответния елемент, докато стойност е неговата стойност. Тези две числа
семантично дефинират отмествания във файловете с данни:
44
• позиция дефинира отместване в d a t a . b i n ;
• стойност дефинира отместване в o u t . b i n .
На базата на тези числови характеристики елементите на l i s t . b i n дефинират правила от вида: “еле-
ментът на отместване позиция в d a t a . b i n трябва да отиде на отместване стойност в o u t . b i n ”.
Забележка: Всички отмествания са спрямо ℕ0 в брой елементи.
Програмата трябва да интепретира по ред дефинираните правила и на тяхна база да генерира изход-
ния файл.
Обърнете внимание на проверките, обработката за грешки и съобщенията към потребителя – искаме
програмата да бъде удобен инструмент.
Забележка: Не е гарантирано, че разполагате с достатъчно памет, в която да заредите всички еле-
менти на който и да от файловете.